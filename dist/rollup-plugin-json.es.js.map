{"version":3,"file":null,"sources":["../src/index.js"],"sourcesContent":["import { createFilter, makeLegalIdentifier } from 'rollup-pluginutils';\r\n\r\nimport path from 'path';\r\n\r\nexport default function json ( options = {} ) {\r\n\tconst filter = createFilter( options.include, options.exclude );\r\n\r\n\treturn {\r\n\t\tname: 'json',\r\n\r\n\t\tresolveId: function(importee, importer) {\r\n\t\t\tif (importee.slice (-5) === '!json') {\r\n\r\n\t\t\t\tlet dir = path.dirname(importer);\r\n\t\t\t\tlet newId = path.normalize(path.join(dir, importee.slice(0, importee.length - 5)));\r\n\r\n\t\t\t\treturn newId;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttransform ( json, id ) {\r\n\t\t\tif ( id.slice( -5 ) !== '.json' ) return null;\r\n\t\t\tif ( !filter( id ) ) return null;\r\n\r\n\t\t\tlet code;\r\n\t\t\tlet ast = {\r\n\t\t\t\ttype: 'Program',\r\n\t\t\t\tsourceType: 'module',\r\n\t\t\t\tstart: 0,\r\n\t\t\t\tend: null,\r\n\t\t\t\tbody: []\r\n\t\t\t};\r\n\r\n\t\t\tif ( json[0] !== '{' ) {\r\n\t\t\t\tcode = `export default ${json};`;\r\n\r\n\t\t\t\tast.body.push({\r\n\t\t\t\t\ttype: 'ExportDefaultDeclaration',\r\n\t\t\t\t\tstart: 0,\r\n\t\t\t\t\tend: code.length,\r\n\t\t\t\t\tdeclaration: {\r\n\t\t\t\t\t\ttype: 'Literal',\r\n\t\t\t\t\t\tstart: 15,\r\n\t\t\t\t\t\tend: code.length - 1,\r\n\t\t\t\t\t\tvalue: null,\r\n\t\t\t\t\t\traw: 'null'\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tconst data = JSON.parse( json );\r\n\r\n\t\t\t\tconst validKeys = [];\r\n\t\t\t\tconst invalidKeys = [];\r\n\r\n\t\t\t\tObject.keys( data ).forEach( key => {\r\n\t\t\t\t\tif ( key === makeLegalIdentifier( key ) ) {\r\n\t\t\t\t\t\tvalidKeys.push( key );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tinvalidKeys.push( key );\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet char = 0;\r\n\t\t\t\tconst namedExports = validKeys.map( key => {\r\n\t\t\t\t\tconst declaration = `export var ${key} = ${JSON.stringify( data[ key ] )};`;\r\n\r\n\t\t\t\t\tconst start = char;\r\n\t\t\t\t\tconst end = start + declaration.length;\r\n\r\n\t\t\t\t\t// generate fake AST node while we're here\r\n\t\t\t\t\tast.body.push({\r\n\t\t\t\t\t\ttype: 'ExportNamedDeclaration',\r\n\t\t\t\t\t\tstart: char,\r\n\t\t\t\t\t\tend: char + declaration.length,\r\n\t\t\t\t\t\tdeclaration: {\r\n\t\t\t\t\t\t\ttype: 'VariableDeclaration',\r\n\t\t\t\t\t\t\tstart: start + 7,\r\n\t\t\t\t\t\t\tend,\r\n\t\t\t\t\t\t\tdeclarations: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttype: 'VariableDeclarator',\r\n\t\t\t\t\t\t\t\t\tstart: start + 11,\r\n\t\t\t\t\t\t\t\t\tend: end - 1,\r\n\t\t\t\t\t\t\t\t\tid: {\r\n\t\t\t\t\t\t\t\t\t\ttype: 'Identifier',\r\n\t\t\t\t\t\t\t\t\t\tstart: start + 11,\r\n\t\t\t\t\t\t\t\t\t\tend: start + 11 + key.length,\r\n\t\t\t\t\t\t\t\t\t\tname: key\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tinit: {\r\n\t\t\t\t\t\t\t\t\t\ttype: 'Literal',\r\n\t\t\t\t\t\t\t\t\t\tstart: start + 11 + key.length + 3,\r\n\t\t\t\t\t\t\t\t\t\tend: end - 1,\r\n\t\t\t\t\t\t\t\t\t\tvalue: null,\r\n\t\t\t\t\t\t\t\t\t\traw: 'null'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\tkind: 'var'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tspecifiers: [],\r\n\t\t\t\t\t\tsource: null\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tchar = end + 1;\r\n\t\t\t\t\treturn declaration;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst defaultExportNode = {\r\n\t\t\t\t\ttype: 'ExportDefaultDeclaration',\r\n\t\t\t\t\tstart: char,\r\n\t\t\t\t\tend: null,\r\n\t\t\t\t\tdeclaration: {\r\n\t\t\t\t\t\ttype: 'ObjectExpression',\r\n\t\t\t\t\t\tstart: char + 15,\r\n\t\t\t\t\t\tend: null,\r\n\t\t\t\t\t\tproperties: []\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tchar += 18; // 'export default {\\n\\t'.length'\r\n\r\n\t\t\t\tconst defaultExportRows = validKeys.map( key => {\r\n\t\t\t\t\tconst row = `${key}: ${key}`;\r\n\r\n\t\t\t\t\tconst start = char;\r\n\t\t\t\t\tconst end = start + row.length;\r\n\r\n\t\t\t\t\tdefaultExportNode.declaration.properties.push({\r\n\t\t\t\t\t\ttype: 'Property',\r\n\t\t\t\t\t\tstart,\r\n\t\t\t\t\t\tend,\r\n\t\t\t\t\t\tmethod: false,\r\n\t\t\t\t\t\tshorthand: false,\r\n\t\t\t\t\t\tcomputed: false,\r\n\t\t\t\t\t\tkey: {\r\n\t\t\t\t\t\t\ttype: 'Identifier',\r\n\t\t\t\t\t\t\tstart,\r\n\t\t\t\t\t\t\tend: start + key.length,\r\n\t\t\t\t\t\t\tname: key\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tvalue: {\r\n\t\t\t\t\t\t\ttype: 'Identifier',\r\n\t\t\t\t\t\t\tstart: start + key.length + 2,\r\n\t\t\t\t\t\t\tend: end,\r\n\t\t\t\t\t\t\tname: key\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tkind: 'init'\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tchar += row.length + 3; // ',\\n\\t'.length\r\n\r\n\t\t\t\t\treturn row;\r\n\t\t\t\t}).concat( invalidKeys.map( key => `\"${key}\": ${JSON.stringify( data[ key ] )}` ) );\r\n\r\n\t\t\t\tconst defaultExportString = `export default {\\n\\t${defaultExportRows.join( ',\\n\\t' )}\\n};`;\r\n\r\n\t\t\t\tast.body.push( defaultExportNode );\r\n\t\t\t\tcode = `${namedExports.join( '\\n' )}\\n${defaultExportString}`;\r\n\r\n\t\t\t\tconst end = code.length;\r\n\r\n\t\t\t\tdefaultExportNode.declaration.end = end - 1;\r\n\t\t\t\tdefaultExportNode.end = end;\r\n\t\t\t}\r\n\r\n\t\t\tast.end = code.length;\r\n\r\n\t\t\treturn { ast, code, map: { mappings: '' } };\r\n\t\t}\r\n\t};\r\n}\r\n"],"names":["const","let"],"mappings":"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"}